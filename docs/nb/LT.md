---
marp: true
---

# tapirのようなものをJDBCで作りたい

---

# tapirとは

エンドポイントの記述とビジネスロジックを分離して記述できるScalaのライブラリ

https://github.com/softwaremill/tapir

---

# tapirを使うメリット

- ルーティング定義からOpenAPIドキュメントを自動生成できるので、ドキュメントの手動管理していると起こりがちな仕様と実装のずれを減らせる
- 実行サーバーの情報を持たないので、サーバーの実装に依存しにくいルーティング定義が書ける
- Interpreter モジュールを差し替えることでサーバーの実装を差し替えることもできる
- 型でしっかりモデリングされているのでコンパイラで間違いを検出できる
- APIクライアントとしても使用することができる

---

# 社内の課題

- プロダクト仕様書の運用
- テストの書きにくさ
- バックエンド/フロントエンドでモデル定義が乱立
- etc...

課題を解決できるのでは？と思い社内のプロダクトをScala2からScala3へ書き換えた時に使用してみました

---

# 実際にプロダクトで使ってみて

ルーティング定義からOpenAPIドキュメントを自動生成できる点はかなり良かった。
ルーティング定義にコメントを書くことができる点も良かった。確かに仕様と実装のずれを減らせると思った。

生成された仕様書からフロントで使用するAPIクライアントの自動生成をすることもできたので、APIクライアントやモデル定義を書く必要がなくなり記述量を減らせた。

サーバーの実装に依存しにくいルーティング定義が書けるおかげでコントローラーなどの実装もどのサーバーで実行されるのかという情報を隠蔽して実装することができた。

---

# こんな感じのものをJDBCでも作りたい

---

# 目指すもの

- テーブル定義からSchemaSPYのドキュメントを自動生成できる
- 実行するライブラリを切り替えられるようにする
- 型でしっかりモデリングしてコンパイラで間違いを検出できる

---



---